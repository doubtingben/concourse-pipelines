resource_types:
  - name: http-api
    type: docker-image
    source:
      repository: aequitas/http-api-resource
      tag: latest

resources:
    - name: rocketchat
      type: http-api
      source:
          uri: http://localhost:3000/hooks/NLWQLkky2cos4F4e2/xeSGAcHS72nyNZ68XFCCFmKzAy3K6KF6H5CqPoRXmNRHjoRQ
          method: POST
          json:
              color: "{color}"
              message: "Build {BUILD_PIPELINE_NAME}{BUILD_JOB_NAME}, nr: {BUILD_NAME} {message}!"
jobs:
    - name: Test and notify
      plan:
          - task: build
            file: ci/build.yaml
            on_success:
                put: rocketchat
                params:
                    color: green
                    message: was a success
            on_failure:
                put: rocketchat
                params:
                    color: red
                    message: failed horribly
